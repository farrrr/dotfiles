{{- if eq .chezmoi.os "darwin" "linux" -}}
#!/usr/bin/env bash

# run_once_after_20_apps_05-mise-install.sh.tmpl
# =============================================================================
# æ­¤è…³æœ¬æœƒåœ¨ chezmoi apply éšæ®µåŸ·è¡Œ `mise install`
# ç¢ºä¿ config.toml ä¸­å®šç¾©çš„æ‰€æœ‰å·¥å…· (Node, Python, Go etc.) éƒ½è¢«å®‰è£
# =============================================================================

set -Eeuo pipefail

function main() {
    local mise_bin="${HOME}/.local/bin/mise"

    # ç¢ºä¿ mise å·²å®‰è£
    if [ ! -x "${mise_bin}" ]; then
        echo "âš ï¸  Mise binary not found at ${mise_bin}. Skipping mise install."
        return 0
    fi

    echo "ğŸ“¦ Running 'mise install' to install tools defined in ~/.config/mise/config.toml..."

    # åŸ·è¡Œå®‰è£
    "${mise_bin}" install -y

    # æ¸…ç†èˆŠç‰ˆæœ¬ (å¯é¸)
    # "${mise_bin}" prune -y
}

main
{{- end -}}
